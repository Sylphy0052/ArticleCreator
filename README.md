# ArticleCreator

Google Apps Script (GAS) をハブとした自律型コンテンツ制作パイプライン。Gemini Gems の調査・生成能力と NotebookLM の資料構成能力を組み合わせ、エンジニア向け高品質記事の制作リードタイムを短縮します。

## 特徴

- **5ステップワークフロー**: 調査 → 執筆 → 画像 → 資料 → 完了
- **プロンプト自動生成**: テーマ入力だけで各工程のプロンプトを生成
- **状態の自動保存**: 作業途中でブラウザを閉じても続きから再開可能
- **Google Drive 連携**: 成果物を自動整理・バージョン管理

## システム構成

```text
┌─────────────────────────────────────────────────────────┐
│                    GAS ダッシュボード                    │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐              │
│  │調査 │ │執筆 │ │画像 │ │資料 │ │完了 │              │
│  └──┬──┘ └──┬──┘ └──┬──┘ └──┬──┘ └──┬──┘              │
└─────┼───────┼───────┼───────┼───────┼──────────────────┘
      │       │       │       │       │
      ▼       ▼       ▼       ▼       ▼
┌─────────┐ ┌─────────┐ ┌───────────┐ ┌──────────────┐
│ Gem A   │ │ Gem B   │ │ Gem C     │ │ NotebookLM   │
│Research │ │Writing  │ │Nanobanana │ │ + Gem D      │
└─────────┘ └─────────┘ └───────────┘ └──────────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │   Google Drive   │
                    │ 成果物フォルダ   │
                    └──────────────────┘
```

## インストール

### 1. GAS プロジェクトの作成

1. [Google スプレッドシート](https://sheets.google.com) を新規作成
2. メニュー「拡張機能」→「Apps Script」を開く
3. `Code.gs` の内容をすべてコピー＆ペースト
4. 保存（Ctrl+S）

### 2. 初回実行（サイドバー形式）

1. スプレッドシートに戻る
2. ページを再読み込み
3. メニュー「ArticleCreator」→「サイドバーを開く」
4. 初回は認証ダイアログが表示されるので許可

### 3. Web アプリとしてデプロイ（任意）

スプレッドシートなしで単独の Web アプリとして使用する場合：

1. Apps Script エディタで「デプロイ」→「新しいデプロイ」をクリック
2. 歯車アイコンから「ウェブアプリ」を選択
3. 以下を設定：
   - **説明**: 任意（例: ArticleCreator v1.0）
   - **次のユーザーとして実行**: 自分
   - **アクセスできるユーザー**: 自分のみ（または必要に応じて変更）
4. 「デプロイ」をクリック
5. 初回はアクセス許可が必要 → 許可
6. 表示された URL をブックマーク

> **注意**: Web アプリ URL から直接アクセスできます。設定や状態は PropertiesService に保存されるため、サイドバー版と共有されます。

### 4. 設定

サイドバー右上の歯車アイコンをクリックして以下を設定：

| 項目 | 説明 |
| ---- | ---- |
| Gem A (Research) URL | 調査用 Gemini Gem の URL |
| Gem B (Writing) URL | 執筆用 Gemini Gem の URL |
| Gem C (Nanobanana) URL | 画像生成用 Gem の URL |
| Gem D (Slides) URL | スライド構成用 Gem の URL |
| 保存先フォルダ ID | Google Drive のフォルダ ID |

## 使い方

### Step 1: 調査タブ

1. テーマを入力（例: 「Next.js 15 の新機能」）
2. 自動生成されたプロンプトを「コピー」
3. 「Gem を開く」で Gem A にアクセス
4. 調査結果をテキストエリアにペースト（省略可）

### Step 2: 執筆タブ

1. ターゲット（エンジニア / デザイナー / PM / 非技術者）を選択
2. トーン（カジュアル / フォーマル / 技術的 など）を選択
3. プロンプトをコピーして Gem B で記事を生成
4. 記事を Markdown 形式でペースト

### Step 3: 画像タブ

1. 記事内容から自動生成された画像プロンプトをコピー
2. Nanobanana で画像を生成
3. 生成した画像をアップロード

### Step 4: 資料タブ

1. スライド構成プロンプトを Gem D にコピー
2. 構成案を NotebookLM にアップロード
3. NotebookLM で PDF を生成
4. PDF をアップロード

### Step 5: 完了タブ

1. 成果物一覧で必要なファイルが揃っているか確認
2. 「全て保存」をクリック
3. Drive にフォルダが自動作成され、全ファイルが保存される

## 出力ファイル構成

```text
[保存先フォルダ]/
  └── [yyyyMMdd_テーマ名_v1]/
      ├── 01_research_results.md   # 調査結果
      ├── 02_theme_article.md      # 記事本体
      ├── 03_thumbnail.png         # アイキャッチ画像
      ├── 04_presentation.pdf      # スライド資料
      └── manifest.json            # メタデータ
```

## 技術仕様

- **プラットフォーム**: Google Apps Script
- **UI フレームワーク**: Material Design Lite 1.3.0
- **データ永続化**: PropertiesService (UserProperties)
- **ファイル構成**: 単一ファイル (Code.gs)
- **デプロイ形式**: サイドバー / Web アプリ（両対応）

## ドキュメント

詳細な設計ドキュメントは `docs/` ディレクトリを参照：

- [docs/spec.md](docs/spec.md) - プロジェクト構成定義書
- [docs/requirements.md](docs/requirements.md) - 要件定義書（EARS記法）
- [docs/design.md](docs/design.md) - 設計書
- [docs/tasks.md](docs/tasks.md) - タスク管理書

## ライセンス

MIT License
